
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html class="theme">
<head>
    <meta charset="utf-8">
    
    <meta name="description" content="LiteHttp：一款智能的HTTP框架类库">
    <meta name="author" content="马天宇">

    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    <link href="../css/base.lib.min.css" rel="stylesheet" media="screen">  
    <!-- id="prettify-style will be used to get the link element below and change href to change prettify code style" -->
    <link id="prettify-style" href="../css/prettify-cmd.css" type="text/css" rel="stylesheet">
    <link href="../css/layout.min.css" rel="stylesheet" media="screen">

    <title>LiteHttp：一款‘智能’的HTTP框架类库</title>

</head>

<body class="theme">

<div id="editor-reader-full" class="editor-reader-full-shown" style="position: static;">
    <div id="reader-full-topInfo" class="reader-full-topInfo-shown">
        <span>
            <code>@litesuits</code>
        </span>
        <code><span id="article-updated-date">2014-03-16 14:06</span></code>
    </div>
    <div id="wmd-preview" class="wmd-preview wmd-preview-full-reader"><h1 id="litehttp一款智能的http框架类库">LiteHttp：一款‘智能’的HTTP框架类库</h1>

<h2 id="简介">简介</h2>

<p>LiteHttp是一款简单、智能、灵活的HTTP框架库，它在请求和响应层面做到了全自动构建和解析，主要用于Android快速开发。借助LiteHttp你只需要一行代码即可完美实现http连接，它全面支持GET, POST, PUT, DELETE, HEAD, TRACE, OPTIONS 和 PATCH八种基本类型。LiteHttp能将Java Model转化为http请求参数，也能将响应的json语句智能转化为Java Model，这种全自动解析策略将节省你大量的构建请求、解析响应的时间。并且，你能自己继承重新实现Dataparser这个抽象类并设置给Request，来将http原始的inputstream转化为任何你想要的东西。</p>

<h2 id="功能">功能</h2>

<ul>
<li><strong>单线程</strong>，所有方法都基于一个线程，绝不会跨线程，多线程的事情交给它自带的AsyncExecutor 或者<a href="https://github.com/litesuits/android-lite-async" target="_blank">更专业的框架库</a>来解决。</li>
<li><strong>灵活的架构</strong>，你可以轻松的替换Json自动化库、参数构建方式甚至默认的apache http client连接方式。</li>
<li>多种请求类型全面支持：<strong>get, post, head, put, delete, trace, options, patch.</strong></li>
<li><strong>多文件上传</strong>，不需要额外的类库支持。</li>
<li>内置的Dataparser支持<strong>文件和位图下载</strong>，你也可以自由的扩展DataParser来把原始的http inputstream转化为你想要的东西。</li>
<li>基于json的<strong>全自动对象转化</strong>：  框架帮你完成Java Object Model 和 Http Parameter之间的转化，完成Http Response与Java Object Model的转化。</li>
<li><strong>自动重定向</strong>，基于一定的次数，不会造成死循环。</li>
<li>自动<strong>gizp</strong>压缩，帮你完成request编码和response解码以使http连接更加快速.</li>
<li>通过网络探测完成<strong>智能重试</strong> ，对复杂的、信号不良的的移动网络做特殊的优化。</li>
<li><strong>禁用一种或多种网络</strong>, 比如2G，3G。</li>
<li>简明且统一的<strong>异常处理</strong>体系：清晰、准确的抛出客户端、网络、服务器三种异常。</li>
<li>内置的AsyncExecutor可以让你轻松实现<strong>异步和并发</strong>的http请求，如果你喜欢，随意使用你自己的AsyncTask或Thread来完成异步，推荐使用<a href="https://github.com/litesuits/android-lite-async" target="_blank">更强大、高效的专业并发库</a>。</li>
</ul>

<h2 id="架构图">架构图</h2>

<h3 id="一个良好的项目结构">一个良好的项目结构：</h3>

<p><img src="http://litesuits.github.io/guide/img/app_archi.png" alt="App Architecture" title=""> <br>
- 底层是业务无关的框架库，用之四海而皆准。 <br>
- 中层是针对业务的三方库，以及主要逻辑实现，全部业务都在这里。 <br>
- 上层是Activity、Fragment、Views&amp;Widget等视图渲染和业务调用。 <br>
这样一个结构，使得你的代码快速在phone和pad以及tv之间迁移，且让你整个更为清晰。 <br>
那么LiteHttp就位于这个结构的底层。</p>

<h3 id="litehttp结构模型">LiteHttp结构模型：</h3>

<p><img src="http://litesuits.github.io/guide/img/litehttp_archi.png" alt="LiteHttp Architecture" title=""></p>

<h2 id="基本用法">基本用法</h2>

<h3 id="基础请求">基础请求</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="typ">LiteHttpClient</span><span class="pln"> client </span><span class="pun">=</span><span class="pln"> </span><span class="typ">ApacheHttpClient</span><span class="pun">.</span><span class="pln">getInstance</span><span class="pun">(</span><span class="pln">context</span><span class="pun">);</span></code></li><li class="L1"><code class="language-java"><span class="typ">Response</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">(</span><span class="str">"http://a.com"</span><span class="pun">));</span></code></li></ol></pre>

<h3 id="异步请求">异步请求</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="typ">HttpAsyncExcutor</span><span class="pln"> asyncExcutor </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HttpAsyncExcutor</span><span class="pun">();</span></code></li><li class="L1"><code class="language-java"><span class="pln">asyncExcutor</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">client</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">(</span><span class="pln">url</span><span class="pun">),</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">HttpResponseHandler</span><span class="pun">()</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L3"><code class="language-java"><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onSuccess</span><span class="pun">(</span><span class="typ">Response</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpStatus</span><span class="pln"> status</span><span class="pun">,</span><span class="pln"> </span><span class="typ">NameValuePair</span><span class="pun">[]</span><span class="pln"> headers</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="com">// do some thing on UI thread</span></code></li><li class="L5"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L6"><code class="language-java"></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="lit">@Override</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="kwd">protected</span><span class="pln"> </span><span class="kwd">void</span><span class="pln"> onFailure</span><span class="pun">(</span><span class="typ">Response</span><span class="pln"> res</span><span class="pun">,</span><span class="pln"> </span><span class="typ">HttpException</span><span class="pln"> e</span><span class="pun">)</span><span class="pln"> </span><span class="pun">{</span></code></li><li class="L9"><code class="language-java"><span class="pln">        </span><span class="com">// do some thing on UI thread </span></code></li><li class="L0"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L1"><code class="language-java"><span class="pun">});</span></code></li></ol></pre>

<h3 id="java-model-作为参数的请求">Java Model 作为参数的请求</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="com">// build a request url as :  http://a.com?name=jame&amp;id=18</span></code></li><li class="L1"><code class="language-java"><span class="typ">Man</span><span class="pln"> man </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Man</span><span class="pun">(</span><span class="str">"jame"</span><span class="pun">,</span><span class="lit">18</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="typ">Response</span><span class="pln"> resonse </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">(</span><span class="str">"http://a.com"</span><span class="pun">,</span><span class="pln">man</span><span class="pun">));</span></code></li></ol></pre>

<p>man class:</p>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="kwd">public</span><span class="pln"> </span><span class="kwd">class</span><span class="pln"> </span><span class="typ">Man</span><span class="pln"> </span><span class="kwd">implements</span><span class="pln"> </span><span class="typ">HttpParam</span><span class="pun">{</span></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="kwd">private</span><span class="pln"> </span><span class="typ">String</span><span class="pln"> name</span><span class="pun">;</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> id</span><span class="pun">;</span></code></li><li class="L3"><code class="language-java"><span class="pln">        </span><span class="kwd">private</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> age</span><span class="pun">;</span></code></li><li class="L4"><code class="language-java"><span class="pln">    </span><span class="kwd">public</span><span class="pln"> </span><span class="typ">Man</span><span class="pun">(</span><span class="typ">String</span><span class="pln"> name</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">int</span><span class="pln"> id</span><span class="pun">){</span></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">name </span><span class="pun">=</span><span class="pln"> name</span><span class="pun">;</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="kwd">this</span><span class="pun">.</span><span class="pln">id</span><span class="pun">=</span><span class="pln"> id</span><span class="pun">;</span></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="pun">}</span></code></li><li class="L8"><code class="language-java"><span class="pun">}</span></code></li></ol></pre>

<h3 id="全自动json转化">全自动Json转化</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="typ">String</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="str">"http://litesuits.github.io/mockdata/user?id=18"</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"><span class="typ">Man</span><span class="pln"> man </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">get</span><span class="pun">(</span><span class="pln">url</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">,</span><span class="pln"> </span><span class="typ">Man</span><span class="pun">.</span><span class="kwd">class</span><span class="pun">);</span></code></li></ol></pre>

<p>man json:</p>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-json"><span class="pun">{</span></code></li><li class="L1"><code class="language-json"><span class="pln">    </span><span class="str">"name"</span><span class="pun">:</span><span class="pln"> </span><span class="str">"jame"</span><span class="pun">,</span></code></li><li class="L2"><code class="language-json"><span class="pln">    </span><span class="str">"age"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">26</span><span class="pun">,</span></code></li><li class="L3"><code class="language-json"><span class="pln">    </span><span class="str">"id"</span><span class="pun">:</span><span class="pln"> </span><span class="lit">18</span></code></li><li class="L4"><code class="language-json"><span class="pun">}</span></code></li></ol></pre>

<h3 id="多文件上传">多文件上传</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="pln">    </span><span class="typ">String</span><span class="pln"> url </span><span class="pun">=</span><span class="pln"> </span><span class="str">"http://192.168.2.108:8080/LiteHttpServer/ReceiveFile"</span><span class="pun">;</span></code></li><li class="L1"><code class="language-java"><span class="pln">    </span><span class="typ">FileInputStream</span><span class="pln"> fis </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileInputStream</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="str">"sdcard/1.jpg"</span><span class="pun">));</span></code></li><li class="L2"><code class="language-java"><span class="pln">    </span><span class="typ">Request</span><span class="pln"> req </span><span class="pun">=</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">(</span><span class="pln">url</span><span class="pun">);</span></code></li><li class="L3"><code class="language-java"><span class="pln">    req</span><span class="pun">.</span><span class="pln">setMethod</span><span class="pun">(</span><span class="typ">HttpMethod</span><span class="pun">.</span><span class="typ">Post</span><span class="pun">)</span></code></li><li class="L4"><code class="language-java"><span class="pln">        </span><span class="pun">.</span><span class="pln">setParamModel</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BaiDuSearch</span><span class="pun">())</span></code></li><li class="L5"><code class="language-java"><span class="pln">        </span><span class="pun">.</span><span class="pln">addParam</span><span class="pun">(</span><span class="str">"lite"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="str">"sdcard/lite.jpg"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"image/jpeg"</span><span class="pun">)</span></code></li><li class="L6"><code class="language-java"><span class="pln">        </span><span class="pun">.</span><span class="pln">addParam</span><span class="pun">(</span><span class="str">"feiq"</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">File</span><span class="pun">(</span><span class="str">"sdcard/feiq.exe"</span><span class="pun">),</span><span class="pln"> </span><span class="str">"application/octet-stream"</span><span class="pun">);</span></code></li><li class="L7"><code class="language-java"><span class="pln">    </span><span class="kwd">if</span><span class="pln"> </span><span class="pun">(</span><span class="pln">fis </span><span class="pun">!=</span><span class="pln"> </span><span class="kwd">null</span><span class="pun">)</span><span class="pln"> req</span><span class="pun">.</span><span class="pln">addParam</span><span class="pun">(</span><span class="str">"meinv"</span><span class="pun">,</span><span class="pln"> fis</span><span class="pun">,</span><span class="pln"> </span><span class="str">"sm.jpg"</span><span class="pun">,</span><span class="pln"> </span><span class="str">"image/jpeg"</span><span class="pun">);</span></code></li><li class="L8"><code class="language-java"><span class="pln">    </span><span class="typ">Response</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">req</span><span class="pun">);</span></code></li></ol></pre>

<h3 id="文件和位图下载">文件和位图下载</h3>

<pre class="prettyprint linenums prettyprinted" style=""><ol class="linenums"><li class="L0"><code class="language-java"><span class="com">// one way</span></code></li><li class="L1"><code class="language-java"><span class="typ">File</span><span class="pln"> file </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="pln">imageUrl</span><span class="pun">,</span><span class="pln"> </span><span class="kwd">new</span><span class="pln"> </span><span class="typ">FileParser</span><span class="pun">(</span><span class="str">"sdcard/lite.jpg"</span><span class="pun">),</span><span class="pln"> </span><span class="typ">HttpMethod</span><span class="pun">.</span><span class="typ">Get</span><span class="pun">);</span></code></li><li class="L2"><code class="language-java"><span class="com">// other way</span></code></li><li class="L3"><code class="language-java"><span class="typ">Response</span><span class="pln"> res </span><span class="pun">=</span><span class="pln"> client</span><span class="pun">.</span><span class="pln">execute</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">Request</span><span class="pun">(</span><span class="pln">imageUrl</span><span class="pun">).</span><span class="pln">setDataParser</span><span class="pun">(</span><span class="kwd">new</span><span class="pln"> </span><span class="typ">BitmapParser</span><span class="pun">()));</span></code></li><li class="L4"><code class="language-java"><span class="typ">Bitmap</span><span class="pln"> bitmap </span><span class="pun">=</span><span class="pln"> res</span><span class="pun">.</span><span class="pln">getBitmap</span><span class="pun">();</span></code></li></ol></pre>

<h3 id="收藏并克隆litehttpstart-and-clone-litehttp-github-仓库吧并且可以看到更多的使用案列方便你进阶">收藏并克隆LiteHttpStart and Clone <a href="https://github.com/litesuits/android-lite-http" target="_blank">LiteHttp Github</a> 仓库吧，并且可以看到更多的使用案列，方便你进阶。</h3>

<h2 id="qq-交流群-47357508">QQ 交流群： 47357508</h2></div>
</div>
</body>
</html>
    
